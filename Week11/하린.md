# 16장. 국제화

- HTTP는 여러 언어와 문자로 된 국제 문서들의 처리 및 전송을 지원해야 한다.
- HTTP 애플리케이션은 여러 언어의 문자로 텍스트를 보여주고 요청하기 위해 문자집합 인코딩을 사용한다. 그리고 그것들은 사용자가 이해할 수 있는 언어만으로 콘텐츠를 서술하기 위해 언터 태그를 사용한다.
- 이 장에서 다룰 내용
  - HTTP가 여러 언어 문자들의 체계 및 표준과 상호작용하는 방법
  - 언어를 위한 표준 명명 체계와, 표준화된 언어 태그가 선택한 콘텐츠를 서술하는 방법
  - 국제화된 URI의 규칙과 주의사항
  - 날짜와 그 외 다른 국제화 이슈

## 16.1 국제적인 콘텐츠를 다루기 위해 필요한 HTTP 지원

- 국제 콘텐츠를 지원하기 위해, 서버는 클라이언트에게 각 문서의 문자와 언어를 알려주고 클라이언트가 올바르게 엔터티 본문을 이루는 비트들을 문자로 풀어내 사용자에게 콘텐츠를 제공해줄 수 있도록 할 필요가 있다.
- 서버는 HTTP Content-Type charset 매개변수와 Content-Language 헤더를 통해 문서의 문자와 언어를 알려준다.
- 동시에, 클라이언트는 서버에게 사용자가 어떤 언어를 이해할 수 있고 어떤 알파벳의 코딩 알고리즘이 브라우저에 설치되어 있는지 말해줄 필요가 있다.
- 클라이언트는 Accept-Charset과 Accept-Language 헤더를 보내 어떤 차셋 알고리즘과 언어를 이해하고 그중 무엇을 선호하는지 말해준다.

## 16.2 문자집합과 HTTP

- 국제 알파벳 스크립트와 그들의 문자집합 인코딩에 대해 알아보자

### 16.2.1 차셋(Charset)은 글자를 비트로 변환하는 인코딩이다

- HTTP 차셋 값은 어떻게 엔터티 콘텐츠 비트들을 특정 문자 체계의 글자들로 바꾸는지 말해준다.
- 각 차셋 태그는 비트들을 글자들로 변환하거나 혹은 그 반대의 일을 해주는 알고리즘을 명명
- 차셋 태그는 MIME 문자집합에 표준화되어 있고, IANA가 관리한다.

- 콘텐츠가 HTML 파일이고, 콘텐츠 비드들을 글자로 디코딩하기 위해 iso-8859-6 아랍 문자집합 디코딩 기법을 사용하라는 Content-Type 예시

```
Content-Type: text/html; charset=iso-8859-6
```

### 16.2.2 문자집합과 인코딩은 어떻게 동작하는가

- 글자를 비트로 인코딩하는 여러 다른 방법이 있기 때문에, 비트들을 문자로 변환하는 디코딩 알고리즘을 지칭하고 적용하는 표준화된 방법이 필요
- 국제화된 문자 시스템의 핵심 목표는 표현(시각적인 표현 방식)에서 의미(글자들)를 분리하는 것.
  - HTTP는 문자 데이터 및 그와 관련된 언어와 차셋 라벨의 전송에만 관심을 가지며, 표현 방법은 사용자의 브라우저, 운영체제, 글꼴등이 결정한다.

디코딩 방법

1. 인코딩 구조(iso-8859-6)의 인코딩 구조를 사용하여 디코딩
2. 디코딩된 문자 코드는 225라는 번호가 붙어있다.
3. 225 값에 해당하는 글자를 찾는다. 225 -> 'ARABIC LETTER FEH'
4. 글꼴과 포맷 소프트웨어를 사용해 화면이 보여줄 모양을 찾는다.

### 16.2.3 잘못된 차셋은 잘못된 글자들을 낳는다.

클라이언트가 잘못된 charset 매개변수를 사용한다면, 클라이언트는 이상한 깨진 글자를 보여주게 될 것이다.

### 16.2.4 표준화된 MIME 차셋 값

- 특정 문자 인코딩과 특정 디코딩된 문자집합의 결합을 MIME 차셋이라고 부른다.
- HTTP는 표준화된 MIME 차셋 태그를 Content-Type과 Accept-Charset 헤더에 사용한다.

### 16.2.5 Content-Type charset 헤더와 META 태그

- 웹 서버는 클라이언트에게 MIME 차셋 태그를 charset 매개변수와 함께 Content-Type 헤더에 담아 보낸다.

```
<HEAD>
    <META HTTP-EQUIV="Content-Type" CONENT="text/html; charset=iso-2022-jp">
    <META LANG="jp">
    <TITLE>A Japanese Document</TITLE>
</HEAD>
```

- 만약 문자집합이 명시적으로 나열되지 않았다면, 수신자는 문서의 콘텐츠로부터 문자집합을 추측하려고 시도한다.
- 추측하지 못햇다면, iso-8859-1로 가정한다.

### 16.2.6 Accept-Charset 헤더

- 대부분의 클라이언트는 모든 종류의 문자 코딩과 매핑 시스템을 지원하지는 않는다.
- HTTP 클라이언트는 그들이 어떤 문자 체계를 지원하는지 Accept-Charset 요청 헤더를 통해 정확히 서버에게 알려준다.
- Accept-Charset 헤더의 값은 클라이언트가 지원하는 문자 인코딩의 목록을 제공한다.
- 응답 문자집합은 MIME과의 호환을 위해 Content-Type 응답 헤더의 charset 매개변수를 통해 서버로부터 돌려받는다.

## 16.3 다중언어 문자 인코딩에 대한 지침

### 16.3.1 문자집합 용어

#### 문자

알파벳 글자, 숫자, 구두점, 표의문자, 기호 등 글쓰기의 최소 단위.

#### 글리프

하나의 글자를 표현하기 위한, 획의 패턴이나 다른 것과 구분되는 유일한 시각적 형태

#### 코딩된 문자

우리가 글자를 다룰 수 있도록 각 글자에 할당된 유일한 숫자

#### 코드 공간

문자 코드 값으로 사용하려고 계획해 둔 정수의 범위

#### 코드 너비

각 문자 코드의 (고정된 크기의) 비트 개수

#### 사용 가능 문자집합

글자들에 대한 특정한 작업 집합

#### 코딩된 문자집합

사용 가능 문자집합을 받아서 각 글자에 코드 공간의 코드를 할당해주는 문자들의 집합. 실제 글자들에 숫자로 된 문자 코드를 대응시킨 것

#### 문자 인코딩 구조

숫자로 된 문자 코드들을 콘텐츠 비트의 연속으로 인코딩하는 알고리즘.

### 16.3.2 차셋(Charset)은 형편없는 이름이다

- 엄밀히 말해, MIME 차셋 태그(Content-Type charset 매개변수와 Accept-Charset 헤더에서 쓰이는)는 문자집합을 의미하는 것이 아니다.
- MIME 차셋 값은 데이터 비트를 고유한 문자의 코드로 매핑하는 알고리즘의 이름이다. 문자 인코딩 구조와 코딩된 문자집합의 개념을 합친 것

### 16.3.3 문자

- 문자는 쓰기의 기본적인 구성요소
- 하나의 문자는 하나의 알파벳 글자, 숫자, 구두점, 표의문자, 기호 혹은 그외 다른 쓰기의 기본 단위를 표현한다.
- 글꼴이나 스타일에 독립적

### 16.3.4 글리프(glyphs), 연자(ligatures) 그리고 표현 형태

- 글리프와 문자를 헷갈리지 말 것. 문자는 유일하고 추상화된 언어의 요소
- 글리프는 각 글자를 그리는 특정한 방법이다. 각 문자는 미적 양식과 스크립트에 따라 여러 가지 글리프를 가진다.

### 16.3.5 코딩된 문자집합(Coded Character Set)

- RFC 2277과 2130에서 정의된 코딩된 문자집합은 정수를 글자로 대응시킨다.
- 코딩된 문자집합은 보통 코드 번호로 인덱싱된 배열로 구현된다. 그 배열의 원소들은 문자들이다.

#### US-ASCII: 모든 문자집합의 어머니

- 아스키는 가장 유명한 코딩된 문자집합이다.
- 아스키는 오직 코드 값 0-127만 사용한다. 따라서 코드 공간 전체를 표현하는데 7비트만이 필요하다.
- 이 문자집합의 다른 국제 변종과 구분하기 위해, 'US-ASCII'라는 이름이 더 선호된다.
- HTTP 메시지는 US-ASCII를 사용

#### iso-8859

- 국제적인 글쓰기를 위해 필요한 글자들을 하이 비트를 이용해서 추가한, US-ASCII의 8비트 확대집합들
- 추가 비트에 의해 제공되는 추가 공간이 모든 유럽 글자를 담기에 충분히 크지 않으므로 지역에 따라 커스터마이징된 문자집합을 제공한다.

#### JIS X 0201

- 아스키를 일본어 가타카나 반각문자를 더해 확장한 극단적으로 작은 문자집합

#### UCS

국제 문자 세트(UCS)는 전 세계의 모든 글자를 하나의 코딩된 문자집합으로 통합하려고 노력하는 세계적인 표준

### 16.3.6 문자 인코딩 구조

- 문자 인코딩 구조들은 숫자로 된 문자 코드를 콘텐츠 비트들로 변환하고 다른 쪽에서는 그들을 다시 문자코드로 환원한다. 크게 세 종류로 분류할 수 있다.

#### 고정폭

- 고정폭 인코딩은 각 코딩된 문자를 고정된 길이의 비트로 표현한다.
- 빠르게 처리될 수 있지만 공간을 낭비할 우려가 있다.

#### 가변폭(비모달)

- 가변폭 인코딩은 다른 문자 코드 번호에 다른 길이의 비트를 사용한다.

#### 가변폭(모달)

- 모달 인코딩은 다른 모드로의 전환을 위해 특별한 'escape' 패턴을 사용한다.

인코딩 구조

#### 8비트

- 8비트 고정폭 아이덴티티 인코딩은 간단히 각 문자 코드를 그에 대응하는 8비트 값으로 인코딩한다.
- 256개 문자의 코드 범위에 대한 문자집합만을 지원한다.
- iso-8859 문자집합군은 8비트 아이덴티티 인코딩을 사용한다.
